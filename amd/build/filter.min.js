define ("local_amos/filter",["exports","core/utils","core/str"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;function d(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function e(a){return function(){var b=this,c=arguments;return new Promise(function(e,f){var i=a.apply(b,c);function g(a){d(i,e,f,g,h,"next",a)}function h(a){d(i,e,f,g,h,"throw",a)}g(void 0)})}}var f={ROOT:{ID:"amosfilter",REGION:"amosfilter"},FCMP:{ID:"amosfilter_fcmp",REGION:"amosfilter_fcmp"},FCMPITEM:{REGION:"amosfilter_fcmp_item"},FCMPCOUNTER:{ID:"amosfilter_fcmp_counter"},FCMPSEARCH:{ID:"amosfilter_fcmp_search"},FLNG:{ID:"amosfilter_flng",REGION:"amosfilter_flng"},FLNGCOUNTER:{ID:"amosfilter_flng_counter"},FLNGSEARCH:{ID:"amosfilter_flng_search"},FVER:{ID:"amosfilter_fver"},FLAST:{ID:"amosfilter_flast"},BUTTONS:{REGION:"amosfilter_buttons"}};a.init=function init(){g();j();l();n();o()};var g=function(){var a=document.getElementById(f.ROOT.ID),c=document.getElementById(f.FCMP.ID),d=document.getElementById(f.FCMPSEARCH.ID),g=document.getElementById(f.FLNG.ID),n=document.getElementById(f.FLNGSEARCH.ID),o=document.getElementById(f.FVER.ID),p=document.getElementById(f.FLAST.ID);a.addEventListener("click",function(b){if(!b.target.hasAttribute("data-action")){return}var d=b.target.getAttribute("data-action"),e=b.target.closest("[data-region]").getAttribute("data-region");if(e==f.FCMP.REGION){h(b,c,d)}if(e==f.BUTTONS.REGION&&"togglemoreoptions"==d){m(b,a)}});a.addEventListener("change",function(a){if(a.target.id.startsWith("amosfilter_fcmp_")){j()}if(a.target.id==f.FLNG.ID){l()}if(a.target.id==f.FLAST.ID){if(p.checked){o.setAttribute("disabled","disabled")}else{o.removeAttribute("disabled")}}});[d,n].forEach(function(a){a.addEventListener("keypress",function(a){if(13==a.keyCode){a.preventDefault();a.stopPropagation()}})});d.addEventListener("input",(0,b.debounce)(function(a){i(a,d,c)},200));n.addEventListener("input",(0,b.debounce)(function(a){k(a,n,g)},200))},h=function(a,b,c){var d=":scope [data-region=\"".concat(f.FCMPITEM.REGION,"\"]:not(.hidden) input[name=\"fcmp[]\"]");if("selectstandard"==c){a.preventDefault();var e=function(a){return"".concat(d,"[data-component-type=\"").concat(a,"\"]")};b.querySelectorAll("".concat(e("core"),", ").concat(e("standard"))).forEach(function(a){a.checked=!0})}if("selectapp"==c){a.preventDefault();b.querySelectorAll("".concat(d,"[data-component-app]")).forEach(function(a){a.checked=!0})}if("selectall"==c){a.preventDefault();b.querySelectorAll("".concat(d)).forEach(function(a){a.checked=!0})}if("selectnone"==c){a.preventDefault();b.querySelectorAll("".concat(d)).forEach(function(a){a.checked=!1})}j()},i=function(a,b,c){var d=b.value.toString().replace(/^ +| +$/,"").toLowerCase();c.querySelectorAll(":scope label[for^=\"amosfilter_fcmp_f_\"]").forEach(function(a){var b=a.closest("[data-region=\"amosfilter_fcmp_item\"]");if(""==d||-1!==a.innerText.toString().toLowerCase().indexOf(d)){b.classList.remove("hidden")}else{b.classList.add("hidden")}})},j=function(){var a=document.getElementById(f.FCMP.ID),b=document.getElementById(f.FCMPCOUNTER.ID),c=a.querySelectorAll(":scope input[name=\"fcmp[]\"]:checked").length;if(0==c){b.classList.add("badge-danger")}else{b.classList.remove("badge-danger")}b.textContent=c},k=function(a,b,c){var d=b.value.toString().replace(/^ +| +$/,"").toLowerCase();c.querySelectorAll(":scope option").forEach(function(a){if(""==d||-1!==a.text.toString().toLowerCase().indexOf(d)){a.classList.remove("hidden");a.removeAttribute("disabled")}else{a.classList.add("hidden");a.setAttribute("disabled","disabled")}})},l=function(){var a=document.getElementById(f.FLNG.ID),b=document.getElementById(f.FLNGCOUNTER.ID),c=a.querySelectorAll(":scope option:checked").length;if(0==c){b.classList.add("badge-danger")}else{b.classList.remove("badge-danger")}b.textContent=c},m=function(){var a=e(regeneratorRuntime.mark(function a(b,d){return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:b.preventDefault();if(!("0"==d.getAttribute("data-level-showadvanced"))){a.next=8;break}d.setAttribute("data-level-showadvanced",1);a.next=5;return(0,c.get_string)("lessfilteringoptions","local_amos");case 5:b.target.innerText=a.sent;a.next=13;break;case 8:d.setAttribute("data-level-showadvanced",0);a.next=11;return(0,c.get_string)("morefilteringoptions","local_amos");case 11:b.target.innerText=a.sent;n();case 13:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),n=function(){var a=document.getElementById(f.ROOT.ID);a.querySelectorAll(":scope [data-level=\"advanced\"][data-level-control]").forEach(function(a){var b=document.getElementById(a.getAttribute("data-level-control")),c=!1;if("input"==b.tagName.toLowerCase()&&"checkbox"==b.getAttribute("type")&&b.checked){c=!0}if("input"==b.tagName.toLowerCase()&&"text"==b.getAttribute("type")&&""!==b.value){c=!0}if("select"==b.tagName.toLowerCase()&&b.hasAttribute("data-default")&&!b.hasAttribute("disabled")){var d=b.querySelectorAll(":scope option:checked");if(1!=d.length){c=!0}else{d.forEach(function(a){window.console.log(a.value);if(a.value!==b.getAttribute("data-default")){c=!0}})}}if(c){a.setAttribute("data-level-forceshow",1)}else{a.removeAttribute("data-level-forceshow")}});a.querySelectorAll(":scope [data-level=\"advanced\"][data-level-control]").forEach(function(a){var b=document.getElementById(a.getAttribute("data-level-control"));if("fieldset"==b.tagName.toLowerCase()){if(b.querySelector("[data-level-forceshow]")){a.setAttribute("data-level-forceshow",1)}else{a.removeAttribute("data-level-forceshow")}}})},o=function(){var a=document.getElementById(f.FCMP.ID).querySelector("input[id^=\"amosfilter_fcmp_f_\"]:checked");if(a){a.scrollIntoView(!1)}}});
//# sourceMappingURL=filter.min.js.map
