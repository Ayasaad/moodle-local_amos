define ("local_amos/filter",["exports","core/utils","core/str"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;function d(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function e(a){return function(){var b=this,c=arguments;return new Promise(function(e,f){var i=a.apply(b,c);function g(a){d(i,e,f,g,h,"next",a)}function h(a){d(i,e,f,g,h,"throw",a)}g(void 0)})}}a.init=function init(){f();i();k();m();n()};var f=function(){var a=document.getElementById("amosfilter"),c=document.getElementById("amosfilter_fcmp"),d=document.getElementById("amosfilter_fcmp_search"),f=document.getElementById("amosfilter_flng"),m=document.getElementById("amosfilter_flng_search"),n=document.getElementById("amosfilter_fver"),o=document.getElementById("amosfilter_flast");a.addEventListener("click",function(b){if(!b.target.hasAttribute("data-action")){return}var d=b.target.getAttribute("data-action"),e=b.target.closest("[data-region]").getAttribute("data-region");if("amosfilter_fcmp"==e){g(b,c,d)}if("amosfilter_buttons"==e&&"togglemoreoptions"==d){l(b,a)}});a.addEventListener("change",function(a){if(a.target.id.startsWith("amosfilter_fcmp_")){i()}if("amosfilter_flng"==a.target.id){k()}if("amosfilter_flast"==a.target.id){if(o.checked){n.setAttribute("disabled","disabled")}else{n.removeAttribute("disabled")}}});[d,m].forEach(function(a){a.addEventListener("keypress",function(a){if(13==a.keyCode){a.preventDefault();a.stopPropagation()}})});d.addEventListener("input",(0,b.debounce)(function(a){h(a,d,c)},200));m.addEventListener("input",(0,b.debounce)(function(a){j(a,m,f)},200))},g=function(a,b,c){if("selectstandard"==c){a.preventDefault();var d=function(a){return"".concat(":scope [data-region=\"amosfilter_fcmp_item\"]:not(.hidden) input[name=\"fcmp[]\"]","[data-component-type=\"").concat(a,"\"]")};b.querySelectorAll("".concat(d("core"),", ").concat(d("standard"))).forEach(function(a){a.checked=!0})}if("selectapp"==c){a.preventDefault();b.querySelectorAll("".concat(":scope [data-region=\"amosfilter_fcmp_item\"]:not(.hidden) input[name=\"fcmp[]\"]","[data-component-app]")).forEach(function(a){a.checked=!0})}if("selectall"==c){a.preventDefault();b.querySelectorAll("".concat(":scope [data-region=\"amosfilter_fcmp_item\"]:not(.hidden) input[name=\"fcmp[]\"]")).forEach(function(a){a.checked=!0})}if("selectnone"==c){a.preventDefault();b.querySelectorAll("".concat(":scope [data-region=\"amosfilter_fcmp_item\"]:not(.hidden) input[name=\"fcmp[]\"]")).forEach(function(a){a.checked=!1})}i()},h=function(a,b,c){var d=b.value.toString().replace(/^ +| +$/,"").toLowerCase();c.querySelectorAll(":scope label[for^=\"amosfilter_fcmp_f_\"]").forEach(function(a){var b=a.closest("[data-region=\"amosfilter_fcmp_item\"]");if(""==d||-1!==a.innerText.toString().toLowerCase().indexOf(d)){b.classList.remove("hidden")}else{b.classList.add("hidden")}})},i=function(){var a=document.getElementById("amosfilter_fcmp"),b=document.getElementById("amosfilter_fcmp_counter"),c=document.getElementById("amosfilter_fcmp_invalid_feedback"),d=a.querySelectorAll(":scope input[name=\"fcmp[]\"]:checked").length;if(0==d){b.classList.add("badge-danger");a.classList.add("is-invalid");c.classList.remove("hidden")}else{b.classList.remove("badge-danger");a.classList.remove("is-invalid");c.classList.add("hidden")}b.textContent=d},j=function(a,b,c){var d=b.value.toString().replace(/^ +| +$/,"").toLowerCase();c.querySelectorAll(":scope option").forEach(function(a){if(""==d||-1!==a.text.toString().toLowerCase().indexOf(d)){a.classList.remove("hidden");a.removeAttribute("disabled")}else{a.classList.add("hidden");a.setAttribute("disabled","disabled")}})},k=function(){var a=document.getElementById("amosfilter_flng"),b=document.getElementById("amosfilter_flng_counter"),c=document.getElementById("amosfilter_flng_invalid_feedback"),d=a.querySelectorAll(":scope option:checked").length;if(0==d){b.classList.add("badge-danger");a.classList.add("is-invalid");c.classList.remove("hidden")}else{b.classList.remove("badge-danger");a.classList.remove("is-invalid");c.classList.add("hidden")}b.textContent=d},l=function(){var a=e(regeneratorRuntime.mark(function a(b,d){return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:b.preventDefault();if(!("0"==d.getAttribute("data-level-showadvanced"))){a.next=8;break}d.setAttribute("data-level-showadvanced",1);a.next=5;return(0,c.get_string)("lessfilteringoptions","local_amos");case 5:b.target.innerText=a.sent;a.next=13;break;case 8:d.setAttribute("data-level-showadvanced",0);a.next=11;return(0,c.get_string)("morefilteringoptions","local_amos");case 11:b.target.innerText=a.sent;m();case 13:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),m=function(){var a=document.getElementById("amosfilter");a.querySelectorAll(":scope [data-level=\"advanced\"][data-level-control]").forEach(function(a){var b=document.getElementById(a.getAttribute("data-level-control")),c=!1;if("input"==b.tagName.toLowerCase()&&"checkbox"==b.getAttribute("type")&&b.checked){c=!0}if("input"==b.tagName.toLowerCase()&&"text"==b.getAttribute("type")&&""!==b.value){c=!0}if("select"==b.tagName.toLowerCase()&&b.hasAttribute("data-default")&&!b.hasAttribute("disabled")){var d=b.querySelectorAll(":scope option:checked");if(1!=d.length){c=!0}else{d.forEach(function(a){window.console.log(a.value);if(a.value!==b.getAttribute("data-default")){c=!0}})}}if(c){a.setAttribute("data-level-forceshow",1)}else{a.removeAttribute("data-level-forceshow")}});a.querySelectorAll(":scope [data-level=\"advanced\"][data-level-control]").forEach(function(a){var b=document.getElementById(a.getAttribute("data-level-control"));if("fieldset"==b.tagName.toLowerCase()){if(b.querySelector("[data-level-forceshow]")){a.setAttribute("data-level-forceshow",1)}else{a.removeAttribute("data-level-forceshow")}}})},n=function(){var a=document.getElementById("amosfilter_fcmp").querySelector("input[id^=\"amosfilter_fcmp_f_\"]:checked");if(a){a.scrollIntoView(!1)}}});
//# sourceMappingURL=filter.min.js.map
