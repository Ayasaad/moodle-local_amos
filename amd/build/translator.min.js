define ("local_amos/translator",["exports","core/ajax","core/config","core/notification"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;c=e(c);d=e(d);function e(a){return a&&a.__esModule?a:{default:a}}a.init=function init(){f();j()};var f=function(){var a=document.getElementById("amostranslator");a.addEventListener("click",function(a){if(a.target.classList.contains("amostranslation")||a.target.classList.contains("amostranslationview")){var b=a.target.closest("[data-region=\"amostranslatoritem\"]");if("view"==b.getAttribute("data-mode")){g(b,a.ctrlKey).focus()}}});a.addEventListener("blur",function(a){if(a.target.hasAttribute("data-region")&&"amoseditor"==a.target.getAttribute("data-region")){h(a.target)}},!0)},g=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1,c=a.querySelector("[data-region=\"amoseditor\"]"),d=a.querySelector(".amostranslation").clientHeight;a.setAttribute("data-nocleaning",b?"1":"0");c.setAttribute("data-previous",c.value);if(40<d){c.style.height=d-9+"px"}a.setAttribute("data-mode","edit");return c},h=function(a){var b=a.closest("[data-region=\"amostranslatoritem\"]"),c=b.getAttribute("data-nocleaning"),e=a.getAttribute("data-previous"),f=a.value;if("1"===c){f=f.trim()}if(e===f&&"1"!==c){a.value=e;b.setAttribute("data-mode","view");return Promise.resolve(!1)}else{b.classList.add("staged");a.disabled=!0;return i(b,f).then(function(c){b.setAttribute("data-mode","view");a.disabled=!1;a.removeAttribute("data-previous");a.innerHTML=a.value=c.translation;b.querySelector("[data-region=\"amostranslationview\"]").innerHTML=c.displaytranslation;b.querySelector("[data-region=\"displaytranslationsince\"]").innerHTML=c.displaytranslationsince+" | ";window.console.log(c);return!0}).catch(d.default.exception)}},i=function(a,d){return(0,b.call)([{methodname:"local_amos_stage_translated_string",args:{stageid:c.default.sesskey,originalid:a.getAttribute("data-originalid"),lang:a.getAttribute("data-language"),text:d,translationid:parseInt(a.getAttribute("data-translationid"))||0,nocleaning:a.getAttribute("data-nocleaning")}}])[0]},j=function(){var a=document.getElementById("amostranslator"),b=a.querySelectorAll(":scope [data-region=\"amostranslatoritem\"].missing");b.forEach(g)}});
//# sourceMappingURL=translator.min.js.map
